<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>特約醫師巡診掛號及就診狀況單</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
  <style>
    body { font-family: "Noto Sans TC", "Microsoft JhengHei", sans-serif; font-size: 10pt; }
    .title { text-align: center; font-weight: bold; font-size: 16pt; margin-bottom: 10px; }
    table { width: 100%; border-collapse: collapse; }
    th, td { border: 1px solid #000; padding: 3px 4px; font-size: 10pt; vertical-align: middle; }
    th { text-align: center; font-weight: 600; }
    .no-print { margin-bottom: 10px; }
    .signature { margin-top: 16px; font-size: 10pt; }
    @media print {
      @page { size: A4 portrait; margin: 15mm; }
      .no-print { display: none !important; }
      body { -webkit-print-color-adjust: exact; }
    }
  </style>
</head>
<body>
<div class="container my-3">
  <div class="no-print text-end mb-3">
    <label>巡診日期：</label>
    <input type="date" id="round-date">
    <button id="load-btn" class="btn btn-secondary btn-sm">載入 / 建立</button>
    <button id="add-row-btn" class="btn btn-success btn-sm">新增列</button>
    <button id="save-btn" class="btn btn-primary btn-sm">儲存</button>
    <button id="export-btn" class="btn btn-outline-success btn-sm">匯出 Excel</button>
    <button id="print-btn" class="btn btn-outline-dark btn-sm">列印</button>
  </div>

  <div class="title">特約醫師巡診掛號及就診狀況單</div>
  <div>醫巡日期：<span id="display-date"></span>　看診人數：<span id="patient-count">0</span></div>

  <table id="round-table" class="mt-2">
    <thead>
    <tr>
      <th style="width:50px;">排序</th>
      <th style="width:80px;">床號</th>
      <th style="width:120px;">姓名</th>
      <th style="width:150px;">身分證字號</th>
      <th style="width:200px;">生命徵象</th>
      <th style="width:200px;">病情簡述</th>
      <th style="width:200px;">醫師手記</th>
      <th class="no-print" style="width:60px;">操作</th>
    </tr>
    </thead>
    <tbody id="round-tbody"></tbody>
  </table>

  <div class="signature">
    <div>
      特約醫巡醫師簽章：<span style="display:inline-block;width:200px;border-bottom:1px solid #000;"></span>
      當日跟診護理師簽名：<span style="display:inline-block;width:200px;border-bottom:1px solid #000;"></span>
    </div>
    <div class="mt-1">
      醫巡日期：<span id="sign-date" style="display:inline-block;width:150px;border-bottom:1px solid #000;"></span>
    </div>
  </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-firestore.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
<script src="firebase-init.js"></script>
<script src="doctor-rounds.js"></script>
</body>
</html>
